<% content_for :title, "Jean Dupont - Utilisateur" %>

<div class="admin-page-header">
  <div class="header-with-actions">
    <div>
      <%= link_to "← Retour aux utilisateurs", admin_users_path, class: "back-link" %>
      <h1>Jean Dupont</h1>
      <p class="text-muted">Dupont Maçonnerie • Membre depuis 3 mois</p>
    </div>
    <div class="header-actions">
      <%= link_to "Modifier", edit_admin_user_path(1), class: "btn btn-primary" %>
      <%= link_to "Stripe Portal", stripe_portal_admin_user_path(1), method: :post, class: "btn btn-outline" %>
      <%= link_to "Suspendre", suspend_admin_user_path(1), method: :post, class: "btn btn-danger", data: { confirm: "Êtes-vous sûr de vouloir suspendre ce compte ?" } %>
    </div>
  </div>
</div>

<!-- User Overview Cards -->
<div class="stats-grid">
  <div class="stat-card">
    <div class="stat-label">Documents générés</div>
    <div class="stat-value">87</div>
    <div class="stat-detail">42 devis, 45 factures</div>
  </div>
  <div class="stat-card">
    <div class="stat-label">Abonnement</div>
    <div class="stat-value success-text">Actif</div>
    <div class="stat-detail">Prochain paiement: 15 juin 2025</div>
  </div>
  <div class="stat-card">
    <div class="stat-label">WhatsApp</div>
    <div class="stat-value success-text">Connecté</div>
    <div class="stat-detail">+33 6 12 34 56 78</div>
  </div>
  <div class="stat-card">
    <div class="stat-label">Messages WhatsApp</div>
    <div class="stat-value">247</div>
    <div class="stat-detail">Ce mois: 89 messages</div>
  </div>
</div>

<!-- User Details -->
<div class="admin-content-grid">
  <div class="admin-card">
    <div class="card-header">
      <h2>Informations personnelles</h2>
      <%= link_to "Modifier", edit_admin_user_path(1), class: "btn btn-sm btn-outline" %>
    </div>
    <div class="details-list">
      <div class="detail-item">
        <span class="detail-label">Nom complet</span>
        <span class="detail-value">Jean Dupont</span>
      </div>
      <div class="detail-item">
        <span class="detail-label">Email</span>
        <span class="detail-value">jean.dupont@example.fr</span>
      </div>
      <div class="detail-item">
        <span class="detail-label">Téléphone</span>
        <span class="detail-value">+33 6 12 34 56 78</span>
      </div>
      <div class="detail-item">
        <span class="detail-label">Langue préférée</span>
        <span class="detail-value">🇫🇷 Français</span>
      </div>
      <div class="detail-item">
        <span class="detail-label">Date d'inscription</span>
        <span class="detail-value">15 mars 2025</span>
      </div>
      <div class="detail-item">
        <span class="detail-label">Dernière connexion</span>
        <span class="detail-value">Aujourd'hui à 14:23</span>
      </div>
    </div>
  </div>

  <div class="admin-card">
    <div class="card-header">
      <h2>Informations entreprise</h2>
    </div>
    <div class="details-list">
      <div class="detail-item">
        <span class="detail-label">Nom de l'entreprise</span>
        <span class="detail-value">Dupont Maçonnerie</span>
      </div>
      <div class="detail-item">
        <span class="detail-label">SIRET</span>
        <span class="detail-value">123 456 789 00012</span>
      </div>
      <div class="detail-item">
        <span class="detail-label">Numéro de TVA</span>
        <span class="detail-value">FR12345678901</span>
      </div>
      <div class="detail-item">
        <span class="detail-label">Adresse</span>
        <span class="detail-value">15 Rue de la Maçonnerie<br>75010 Paris, France</span>
      </div>
    </div>
  </div>
</div>

<!-- Subscription Details -->
<div class="admin-card" style="margin-top: var(--spacing-xl);">
  <div class="card-header">
    <h2>Détails de l'abonnement</h2>
    <%= link_to "Ouvrir Stripe Dashboard", "#", class: "btn btn-sm btn-outline", target: "_blank" %>
  </div>
  <div class="details-list">
    <div class="detail-item">
      <span class="detail-label">Statut</span>
      <span class="detail-value"><span class="status-badge status-success">Actif</span></span>
    </div>
    <div class="detail-item">
      <span class="detail-label">Plan</span>
      <span class="detail-value">Mensuel - 59€/mois</span>
    </div>
    <div class="detail-item">
      <span class="detail-label">Stripe Customer ID</span>
      <span class="detail-value">cus_AbCdEfGhIjKl</span>
    </div>
    <div class="detail-item">
      <span class="detail-label">Stripe Subscription ID</span>
      <span class="detail-value">sub_1234567890</span>
    </div>
    <div class="detail-item">
      <span class="detail-label">Date de début</span>
      <span class="detail-value">15 mars 2025</span>
    </div>
    <div class="detail-item">
      <span class="detail-label">Prochain paiement</span>
      <span class="detail-value">15 juin 2025</span>
    </div>
    <div class="detail-item">
      <span class="detail-label">Moyen de paiement</span>
      <span class="detail-value">Carte •••• 4242</span>
    </div>
  </div>
</div>

<!-- Recent Activity -->
<div class="admin-card" style="margin-top: var(--spacing-xl);">
  <div class="card-header">
    <h2>Activité récente</h2>
    <%= link_to "Voir tous les logs", logs_admin_user_path(1), class: "btn btn-sm btn-outline" %>
  </div>
  <div class="activity-list">
    <div class="activity-item">
      <div class="activity-icon bg-blue">📄</div>
      <div class="activity-content">
        <div class="activity-title">Facture créée via WhatsApp</div>
        <div class="activity-meta">Facture #F-2025-0234 - Il y a 2 heures</div>
      </div>
    </div>
    <div class="activity-item">
      <div class="activity-icon bg-green">💬</div>
      <div class="activity-content">
        <div class="activity-title">Message WhatsApp traité</div>
        <div class="activity-meta">Command vocale transcrite - Il y a 2 heures</div>
      </div>
    </div>
    <div class="activity-item">
      <div class="activity-icon bg-purple">📋</div>
      <div class="activity-content">
        <div class="activity-title">Devis créé via WhatsApp</div>
        <div class="activity-meta">Devis #D-2025-0456 - Il y a 5 heures</div>
      </div>
    </div>
    <div class="activity-item">
      <div class="activity-icon bg-green">💳</div>
      <div class="activity-content">
        <div class="activity-title">Paiement mensuel reçu</div>
        <div class="activity-meta">59€ - Il y a 3 jours</div>
      </div>
    </div>
    <div class="activity-item">
      <div class="activity-icon bg-blue">👤</div>
      <div class="activity-content">
        <div class="activity-title">Connexion au dashboard</div>
        <div class="activity-meta">IP: 192.168.1.1 - Il y a 1 semaine</div>
      </div>
    </div>
  </div>
</div>

<!-- Quick Actions -->
<div class="admin-card" style="margin-top: var(--spacing-xl);">
  <div class="card-header">
    <h2>Actions rapides</h2>
  </div>
  <div class="quick-actions-grid">
    <%= link_to reset_whatsapp_admin_user_path(1), method: :post, class: "btn btn-outline btn-block", data: { confirm: "Forcer la reconnexion WhatsApp ?" } do %>
      🔄 Réinitialiser WhatsApp
    <% end %>
    <%= link_to stripe_portal_admin_user_path(1), method: :post, class: "btn btn-outline btn-block" do %>
      💳 Ouvrir Stripe Portal
    <% end %>
    <%= link_to edit_admin_user_path(1), class: "btn btn-outline btn-block" do %>
      ✏️ Modifier les informations
    <% end %>
    <%= link_to logs_admin_user_path(1), class: "btn btn-outline btn-block" do %>
      📝 Voir tous les logs
    <% end %>
    <%= link_to suspend_admin_user_path(1), method: :post, class: "btn btn-danger btn-block", data: { confirm: "Êtes-vous sûr de vouloir suspendre ce compte ?" } do %>
      ⛔ Suspendre le compte
    <% end %>
  </div>
</div>
