<% content_for :title, "Logs - #{@user.display_name} - Admin" %>

<div class="admin-page-header">
  <div>
    <%= link_to "‚Üê Retour √† l'utilisateur", admin_user_path(@user), class: "back-link" %>
    <h1>Logs d'activit√© - <%= @user.display_name %></h1>
    <p class="text-muted">Historique des √©v√©nements (SystemLog)</p>
  </div>
</div>

<div class="admin-card" style="margin-bottom: var(--spacing-lg);">
  <h3 class="filters-title">Filtres</h3>
  <%= form_with url: logs_admin_user_path(@user), method: :get, local: true, class: "filters-bar" do %>
    <div class="search-box">
      <%= text_field_tag :q, params[:q], type: :search, placeholder: "Rechercher dans les logs (event/description)...", class: "form-input" %>
    </div>

    <div class="filter-group">
      <%= select_tag :log_type,
            options_for_select([
              ["Tous les types", ""],
              ["Info", "info"],
              ["Warning", "warning"],
              ["Error", "error"],
              ["Audit", "audit"]
            ], params[:log_type]),
            class: "form-select" %>
    </div>

    <div class="filter-actions">
      <%= link_to logs_admin_user_path(@user), class: "btn btn-outline" do %>
        <span>Effacer</span>
      <% end %>
      <button class="btn btn-primary" type="submit">Filtrer</button>
    </div>
  <% end %>
</div>

<div class="admin-card">
  <div class="card-header">
    <h2>Historique</h2>
  </div>

  <div class="activity-list">
    <% @logs.each do |log| %>
      <div class="activity-item">
        <div class="activity-icon bg-blue">üìù</div>
        <div class="activity-content">
          <div class="activity-title"><%= log.event %></div>
          <div class="activity-meta"><%= l(log.created_at) %> ‚Ä¢ <%= log.log_type %></div>
          <% if log.description.present? %>
            <div class="activity-detail"><%= log.description %></div>
          <% end %>
        </div>
        <div class="activity-status">
          <span class="status-badge"><%= log.log_type %></span>
        </div>
      </div>
    <% end %>

    <% if @logs.empty? %>
      <div class="text-muted" style="padding: var(--spacing-lg);">Aucun log.
      </div>
    <% end %>
  </div>
</div>

<%= render 'shared/pagination', collection: @logs %>
