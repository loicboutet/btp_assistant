<% content_for :title, "Logs système - Admin" %>

<div class="admin-page-header">
  <h1>Logs système</h1>
  <p class="text-muted">Surveillance de l'activité de l'application</p>
</div>

<!-- Filters -->
<div class="admin-card" style="margin-bottom: var(--spacing-lg);">
  <h3 class="filters-title">Filtres de recherche</h3>
  <div class="filters-bar">
    <div class="search-box">
      <input type="search" placeholder="Rechercher dans les logs..." class="form-input">
    </div>
    <div class="filter-group">
      <select class="form-select">
        <option>Tous les types</option>
        <option>User</option>
        <option>Subscription</option>
        <option>Document</option>
        <option>WhatsApp</option>
        <option>Webhook</option>
        <option>Error</option>
      </select>
    </div>
    <div class="filter-group">
      <select class="form-select">
        <option selected>Aujourd'hui</option>
        <option>7 derniers jours</option>
        <option>30 derniers jours</option>
        <option>Tout</option>
      </select>
    </div>
    <div class="filter-actions">
      <button class="btn btn-outline">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="20" height="20">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
        </svg>
        <span>Effacer</span>
      </button>
      <button class="btn btn-primary">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="20" height="20">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 01-.659 1.591l-5.432 5.432a2.25 2.25 0 00-.659 1.591v2.927a2.25 2.25 0 01-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 00-.659-1.591L3.659 7.409A2.25 2.25 0 013 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0112 3z" />
        </svg>
        <span>Filtrer</span>
      </button>
    </div>
  </div>
</div>

<!-- Logs Table -->
<div class="admin-card">
  <table class="admin-table">
    <thead>
      <tr>
        <th>Horodatage</th>
        <th>Type</th>
        <th>Utilisateur</th>
        <th>Action</th>
        <th>Détails</th>
        <th>Statut</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td class="text-nowrap">2025-05-30 14:23:45</td>
        <td><span class="badge badge-blue">User</span></td>
        <td>
          <div class="user-info-compact">
            <div class="user-avatar-sm">MY</div>
            <span>Mehmet Yılmaz</span>
          </div>
        </td>
        <td>user.registered</td>
        <td class="text-muted small">Nouvel utilisateur inscrit via Stripe</td>
        <td><span class="status-badge status-success">Success</span></td>
        <td>
          <%= link_to admin_log_path(1), class: "btn btn-xs btn-outline btn-with-icon" do %>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16">
              <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z" />
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
            <span>Détails</span>
          <% end %>
        </td>
      </tr>
      <tr>
        <td class="text-nowrap">2025-05-30 14:08:12</td>
        <td><span class="badge badge-purple">Document</span></td>
        <td>
          <div class="user-info-compact">
            <div class="user-avatar-sm">JD</div>
            <span>Jean Dupont</span>
          </div>
        </td>
        <td>invoice.created</td>
        <td class="text-muted small">Facture #F-2025-0234 créée via WhatsApp</td>
        <td><span class="status-badge status-success">Success</span></td>
        <td>
          <%= link_to admin_log_path(2), class: "btn btn-xs btn-outline btn-with-icon" do %>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16">
              <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z" />
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
            <span>Détails</span>
          <% end %>
        </td>
      </tr>
      <tr>
        <td class="text-nowrap">2025-05-30 13:45:33</td>
        <td><span class="badge badge-green">WhatsApp</span></td>
        <td>
          <div class="user-info-compact">
            <div class="user-avatar-sm">JD</div>
            <span>Jean Dupont</span>
          </div>
        </td>
        <td>whatsapp.message_received</td>
        <td class="text-muted small">Message vocal transcrit (French)</td>
        <td><span class="status-badge status-success">Success</span></td>
        <td>
          <%= link_to admin_log_path(3), class: "btn btn-xs btn-outline btn-with-icon" do %>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16">
              <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z" />
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
            <span>Détails</span>
          <% end %>
        </td>
      </tr>
      <tr>
        <td class="text-nowrap">2025-05-30 12:15:22</td>
        <td><span class="badge badge-orange">Webhook</span></td>
        <td>
          <div class="user-info-compact">
            <div class="user-avatar-sm">MM</div>
            <span>Marie Martin</span>
          </div>
        </td>
        <td>stripe.payment_succeeded</td>
        <td class="text-muted small">Paiement mensuel de 59€ reçu</td>
        <td><span class="status-badge status-success">Success</span></td>
        <td>
          <%= link_to admin_log_path(4), class: "btn btn-xs btn-outline btn-with-icon" do %>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16">
              <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z" />
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
            <span>Détails</span>
          <% end %>
        </td>
      </tr>
      <tr>
        <td class="text-nowrap">2025-05-30 11:30:45</td>
        <td><span class="badge badge-purple">Document</span></td>
        <td>
          <div class="user-info-compact">
            <div class="user-avatar-sm">AD</div>
            <span>Ahmet Demir</span>
          </div>
        </td>
        <td>quote.created</td>
        <td class="text-muted small">Devis #D-2025-0456 créé via WhatsApp</td>
        <td><span class="status-badge status-success">Success</span></td>
        <td>
          <%= link_to admin_log_path(5), class: "btn btn-xs btn-outline btn-with-icon" do %>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16">
              <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z" />
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
            <span>Détails</span>
          <% end %>
        </td>
      </tr>
      <tr class="row-warning">
        <td class="text-nowrap">2025-05-30 10:22:18</td>
        <td><span class="badge badge-orange">Webhook</span></td>
        <td>
          <div class="user-info-compact">
            <div class="user-avatar-sm">AÖ</div>
            <span>Ali Öztürk</span>
          </div>
        </td>
        <td>stripe.payment_failed</td>
        <td class="text-muted small">Échec paiement - carte expirée</td>
        <td><span class="status-badge status-warning">Failed</span></td>
        <td>
          <%= link_to admin_log_path(6), class: "btn btn-xs btn-outline btn-with-icon" do %>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16">
              <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z" />
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
            <span>Détails</span>
          <% end %>
        </td>
      </tr>
      <tr>
        <td class="text-nowrap">2025-05-30 09:15:33</td>
        <td><span class="badge badge-green">WhatsApp</span></td>
        <td>
          <div class="user-info-compact">
            <div class="user-avatar-sm">PL</div>
            <span>Pierre Lefebvre</span>
          </div>
        </td>
        <td>whatsapp.connected</td>
        <td class="text-muted small">Compte WhatsApp connecté via Unipile</td>
        <td><span class="status-badge status-success">Success</span></td>
        <td>
          <%= link_to admin_log_path(7), class: "btn btn-xs btn-outline btn-with-icon" do %>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16">
              <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z" />
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
            <span>Détails</span>
          <% end %>
        </td>
      </tr>
      <tr class="row-danger">
        <td class="text-nowrap">2025-05-30 08:42:11</td>
        <td><span class="badge badge-red">Error</span></td>
        <td>
          <div class="user-info-compact">
            <div class="user-avatar-sm">SB</div>
            <span>Sophie Bernard</span>
          </div>
        </td>
        <td>subscription.suspended</td>
        <td class="text-muted small">Compte suspendu - impayé 15 jours</td>
        <td><span class="status-badge status-danger">Error</span></td>
        <td>
          <%= link_to admin_log_path(8), class: "btn btn-xs btn-outline btn-with-icon" do %>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16">
              <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z" />
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
            <span>Détails</span>
          <% end %>
        </td>
      </tr>
      <tr>
        <td class="text-nowrap">2025-05-30 07:30:22</td>
        <td><span class="badge badge-blue">User</span></td>
        <td>
          <div class="user-info-compact">
            <div class="user-avatar-sm">CK</div>
            <span>Can Kaya</span>
          </div>
        </td>
        <td>user.login</td>
        <td class="text-muted small">Connexion au dashboard (IP: 89.156.2.45)</td>
        <td><span class="status-badge status-success">Success</span></td>
        <td>
          <%= link_to admin_log_path(9), class: "btn btn-xs btn-outline btn-with-icon" do %>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16">
              <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z" />
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
            <span>Détails</span>
          <% end %>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<!-- Pagination -->
<div class="pagination">
  <button class="btn btn-outline" disabled>Précédent</button>
  <span class="pagination-info">Page 1 sur 42</span>
  <button class="btn btn-outline">Suivant</button>
</div>

<!-- Log Stats -->
<div style="margin-top: var(--spacing-xl);">
  <h2 style="font-size: var(--font-size-xl); font-weight: var(--font-weight-semibold); color: var(--text-dark); margin-bottom: var(--spacing-lg);">Statistiques des logs (24h)</h2>
  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-icon bg-blue">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="32" height="32">
          <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 9.776c.112-.017.227-.026.344-.026h15.812c.117 0 .232.009.344.026m-16.5 0a2.25 2.25 0 00-1.883 2.542l.857 6a2.25 2.25 0 002.227 1.932H19.05a2.25 2.25 0 002.227-1.932l.857-6a2.25 2.25 0 00-1.883-2.542m-16.5 0V6A2.25 2.25 0 016 3.75h3.879a1.5 1.5 0 011.06.44l2.122 2.12a1.5 1.5 0 001.06.44H18A2.25 2.25 0 0120.25 9v.776" />
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-value">847</div>
        <div class="stat-label">Total événements</div>
        <div class="stat-change neutral">Dernières 24h</div>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon bg-green">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="32" height="32">
          <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-value">823</div>
        <div class="stat-label">Succès</div>
        <div class="stat-change positive">97.2% du total</div>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon bg-orange">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="32" height="32">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-value">12</div>
        <div class="stat-label">Warnings</div>
        <div class="stat-change negative">1.4% du total</div>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon" style="background: linear-gradient(135deg, #DC2626 0%, #991B1B 100%);">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="32" height="32">
          <path stroke-linecap="round" stroke-linejoin="round" d="M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-value">12</div>
        <div class="stat-label">Erreurs</div>
        <div class="stat-change negative">1.4% du total</div>
      </div>
    </div>
  </div>
</div>
