<% content_for :title, "Dashboard Admin - Devis WhatsApp" %>

<div class="admin-page-header">
  <h1>Tableau de bord Admin</h1>
  <p class="text-muted">Vue d'ensemble de l'application</p>
</div>

<!-- Stats Cards -->
<div class="stats-grid">
  <div class="stat-card">
    <div class="stat-icon bg-blue">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="32" height="32">
        <path stroke-linecap="round" stroke-linejoin="round" d="M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z" />
      </svg>
    </div>
    <div class="stat-content">
      <div class="stat-value">47</div>
      <div class="stat-label">Utilisateurs actifs</div>
      <div class="stat-change positive">+12% ce mois</div>
    </div>
  </div>

  <div class="stat-card">
    <div class="stat-icon bg-green">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="32" height="32">
        <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 002.25-2.25V6.75A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25v10.5A2.25 2.25 0 004.5 19.5z" />
      </svg>
    </div>
    <div class="stat-content">
      <div class="stat-value">2 847€</div>
      <div class="stat-label">MRR (Revenu mensuel)</div>
      <div class="stat-change positive">+8% ce mois</div>
    </div>
  </div>

  <div class="stat-card">
    <div class="stat-icon bg-purple">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="32" height="32">
        <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
      </svg>
    </div>
    <div class="stat-content">
      <div class="stat-value">1 243</div>
      <div class="stat-label">Documents générés</div>
      <div class="stat-change positive">+156 cette semaine</div>
    </div>
  </div>

  <div class="stat-card">
    <div class="stat-icon bg-orange">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="32" height="32">
        <path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244" />
      </svg>
    </div>
    <div class="stat-content">
      <div class="stat-value">98.2%</div>
      <div class="stat-label">Webhooks réussis</div>
      <div class="stat-change neutral">45 dernières 24h</div>
    </div>
  </div>
</div>

<!-- Recent Activity -->
<div class="admin-content-grid">
  <div class="admin-card">
    <div class="card-header">
      <h2>Activité récente</h2>
      <%= link_to "Voir tout", admin_logs_path, class: "btn btn-sm btn-outline" %>
    </div>
    <div class="activity-list">
      <div class="activity-item">
        <div class="activity-icon bg-green">✓</div>
        <div class="activity-content">
          <div class="activity-title">Nouvel utilisateur inscrit</div>
          <div class="activity-meta">Mehmet Yılmaz - Il y a 2 minutes</div>
        </div>
      </div>
      <div class="activity-item">
        <div class="activity-icon bg-blue">📄</div>
        <div class="activity-content">
          <div class="activity-title">Facture générée</div>
          <div class="activity-meta">Jean Dupont - Il y a 15 minutes</div>
        </div>
      </div>
      <div class="activity-item">
        <div class="activity-icon bg-purple">💳</div>
        <div class="activity-content">
          <div class="activity-title">Paiement reçu</div>
          <div class="activity-meta">Marie Martin - Il y a 1 heure</div>
        </div>
      </div>
      <div class="activity-item">
        <div class="activity-icon bg-orange">🔗</div>
        <div class="activity-content">
          <div class="activity-title">WhatsApp connecté</div>
          <div class="activity-meta">Ahmet Demir - Il y a 2 heures</div>
        </div>
      </div>
      <div class="activity-item">
        <div class="activity-icon bg-green">📋</div>
        <div class="activity-content">
          <div class="activity-title">Devis créé via WhatsApp</div>
          <div class="activity-meta">Pierre Lefebvre - Il y a 3 heures</div>
        </div>
      </div>
    </div>
  </div>

  <div class="admin-card">
    <div class="card-header">
      <h2>Abonnements en alerte</h2>
      <%= link_to "Voir tout", overdue_admin_subscriptions_path, class: "btn btn-sm btn-outline" %>
    </div>
    <div class="alert-list">
      <div class="alert-item warning">
        <div class="alert-icon">⚠️</div>
        <div class="alert-content">
          <div class="alert-title">Paiement échoué</div>
          <div class="alert-meta">Ali Öztürk - 2 jours restants</div>
        </div>
        <button class="btn btn-sm btn-primary">Relancer</button>
      </div>
      <div class="alert-item danger">
        <div class="alert-icon">❌</div>
        <div class="alert-content">
          <div class="alert-title">Compte suspendu</div>
          <div class="alert-meta">Sophie Bernard - Impayé depuis 15 jours</div>
        </div>
        <button class="btn btn-sm btn-outline">Voir</button>
      </div>
      <div class="alert-item warning">
        <div class="alert-icon">⏰</div>
        <div class="alert-content">
          <div class="alert-title">Renouvellement proche</div>
          <div class="alert-meta">Can Kaya - Dans 3 jours</div>
        </div>
        <button class="btn btn-sm btn-outline">Voir</button>
      </div>
    </div>
  </div>
</div>

<!-- Quick Stats -->
<div class="admin-card" style="margin-top: var(--spacing-xl);">
  <div class="card-header">
    <h2>Statistiques rapides</h2>
    <%= link_to "Analytics détaillées", admin_metrics_path, class: "btn btn-sm btn-primary" %>
  </div>
  <div class="quick-stats-grid">
    <div class="quick-stat">
      <div class="quick-stat-label">Nouveaux utilisateurs (7j)</div>
      <div class="quick-stat-value">8</div>
    </div>
    <div class="quick-stat">
      <div class="quick-stat-label">Taux de conversion</div>
      <div class="quick-stat-value">73%</div>
    </div>
    <div class="quick-stat">
      <div class="quick-stat-label">Devis créés (mois)</div>
      <div class="quick-stat-value">542</div>
    </div>
    <div class="quick-stat">
      <div class="quick-stat-label">Factures créées (mois)</div>
      <div class="quick-stat-value">701</div>
    </div>
    <div class="quick-stat">
      <div class="quick-stat-label">Messages WhatsApp</div>
      <div class="quick-stat-value">3 247</div>
    </div>
    <div class="quick-stat">
      <div class="quick-stat-label">Taux de rétention</div>
      <div class="quick-stat-value">94%</div>
    </div>
  </div>
</div>
