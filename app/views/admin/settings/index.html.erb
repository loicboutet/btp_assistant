<% content_for :title, "Paramètres - Admin" %>

<div class="admin-page-header">
  <h1>Paramètres de l'application</h1>
  <p class="text-muted">Configuration générale et intégrations</p>
</div>

<div class="admin-card">
  <div class="card-header">
    <h2>Intégrations</h2>
  </div>

  <div class="details-list">
    <div class="detail-item">
      <span class="detail-label">Unipile</span>
      <span class="detail-value">
        <% if @app_setting.unipile_configured? %>
          <span class="status-badge status-success">Configuré</span>
        <% else %>
          <span class="status-badge status-warning">Non configuré</span>
        <% end %>
        — <%= link_to "Configurer", admin_settings_unipile_path, class: "text-link" %>
      </span>
    </div>

    <div class="detail-item">
      <span class="detail-label">Stripe</span>
      <span class="detail-value">
        <% if @app_setting.stripe_configured? %>
          <span class="status-badge status-success">Configuré</span>
        <% else %>
          <span class="status-badge status-warning">Non configuré</span>
        <% end %>
        — <%= link_to "Configurer", admin_settings_stripe_path, class: "text-link" %>
      </span>
    </div>

    <div class="detail-item">
      <span class="detail-label">OpenAI</span>
      <span class="detail-value">
        <% if @app_setting.openai_configured? %>
          <span class="status-badge status-success">Configuré</span>
        <% else %>
          <span class="status-badge status-warning">Non configuré</span>
        <% end %>
        — <%= link_to "Configurer", admin_settings_openai_path, class: "text-link" %>
      </span>
    </div>

    <div class="detail-item">
      <span class="detail-label">Prompts LLM</span>
      <span class="detail-value">
        <%= link_to "Gérer les prompts", admin_prompts_path, class: "text-link" %>
      </span>
    </div>
  </div>
</div>

<div class="admin-card" style="margin-top: var(--spacing-xl);">
  <div class="card-header">
    <h2>Paramètres techniques</h2>
  </div>

  <%= form_with model: @app_setting, url: admin_settings_path, method: :patch, class: "settings-form" do |f| %>
    <div class="form-fields-grid">
      <div class="form-group">
        <%= f.label :default_trial_days, "Durée d'essai par défaut (jours)", class: "form-label" %>
        <%= f.number_field :default_trial_days, class: "form-input", min: 0, max: 90 %>
        <p class="form-hint">Nombre de jours d'essai gratuit pour les nouveaux utilisateurs (0 = pas d'essai)</p>
      </div>

      <div class="form-group">
        <%= f.label :signed_url_expiration_minutes, "Expiration des liens signés (minutes)", class: "form-label" %>
        <%= f.number_field :signed_url_expiration_minutes, class: "form-input", min: 1, max: 1440 %>
      </div>

      <div class="form-group">
        <%= f.label :conversation_context_messages, "Contexte conversation (messages)", class: "form-label" %>
        <%= f.number_field :conversation_context_messages, class: "form-input", min: 1, max: 50 %>
      </div>

      <div class="form-group">
        <%= f.label :conversation_context_hours, "Contexte conversation (heures)", class: "form-label" %>
        <%= f.number_field :conversation_context_hours, class: "form-input", min: 1, max: 24 %>
      </div>

      <div class="form-group">
        <%= f.label :rate_limit_messages_per_hour, "Rate limit (messages/heure)", class: "form-label" %>
        <%= f.number_field :rate_limit_messages_per_hour, class: "form-input", min: 1, max: 500 %>
      </div>
    </div>

    <div class="form-actions">
      <%= f.submit "Sauvegarder", class: "btn btn-primary" %>
    </div>
  <% end %>
</div>
