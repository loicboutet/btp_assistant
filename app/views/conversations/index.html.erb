<div class="admin-page-header">
  <h1>Historique des Conversations</h1>
  <p class="text-muted">Consultez toutes vos conversations WhatsApp avec vos clients</p>
</div>

<!-- Filters -->
<div class="admin-card" style="margin-bottom: var(--spacing-lg);">
  <h3 class="filters-title">Filtres</h3>
  <div class="filters-bar">
    <div class="search-box">
      <input type="text" class="form-input" placeholder="Rechercher une conversation...">
    </div>
    <div class="filter-group">
      <select class="form-select">
        <option>Tous les types</option>
        <option>Création de devis</option>
        <option>Création de facture</option>
        <option>Création de client</option>
        <option>Conversation générale</option>
      </select>
    </div>
    <div class="filter-group">
      <select class="form-select">
        <option>Tous les statuts</option>
        <option>Actives</option>
        <option>Terminées</option>
        <option>Abandonnées</option>
      </select>
    </div>
  </div>
</div>

<!-- Conversations List -->
<div class="admin-card">
  <div class="card-header">
    <h2>Conversations Récentes</h2>
    <span class="badge badge-blue">24 conversations au total</span>
  </div>

  <div class="activity-list">
    <!-- Active Conversation -->
    <div class="admin-card" style="border-left: 4px solid var(--primary-green); margin-bottom: var(--spacing-md);">
      <div style="display: flex; gap: var(--spacing-md); align-items: flex-start;">
        <div class="activity-icon bg-green" style="flex-shrink: 0;">
          <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
            <path d="M13.601 2.326A7.854 7.854 0 0 0 7.994 0C3.627 0 .068 3.558.064 7.926c0 1.399.366 2.76 1.057 3.965L0 16l4.204-1.102a7.933 7.933 0 0 0 3.79.965h.004c4.368 0 7.926-3.558 7.93-7.93A7.898 7.898 0 0 0 13.6 2.326z"/>
          </svg>
        </div>
        <div style="flex: 1;">
          <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: var(--spacing-sm);">
            <div>
              <h4 style="margin: 0 0 var(--spacing-xs) 0; color: var(--text-dark);">Création de devis - Entreprise Dubois</h4>
              <p class="text-muted small" style="margin: 0;">Conversation avec Marie Dubois • +33 6 98 76 54 32</p>
            </div>
            <span class="status-badge status-success">Active</span>
          </div>
          
          <div class="details-list" style="margin-bottom: var(--spacing-md);">
            <div class="detail-item">
              <span class="detail-label">Type</span>
              <span class="detail-value">
                <span class="badge badge-blue">Création de devis</span>
              </span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Démarrée le</span>
              <span class="detail-value">30 octobre 2025 à 15:45</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Dernière activité</span>
              <span class="detail-value">Il y a 2 minutes</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Messages échangés</span>
              <span class="detail-value">12 messages</span>
            </div>
          </div>

          <div style="padding: var(--spacing-sm); background-color: var(--bg-light); border-radius: var(--radius-md); margin-bottom: var(--spacing-sm);">
            <strong style="font-size: var(--font-size-sm); color: var(--text-gray);">Progression:</strong>
            <p style="margin: 0.5rem 0 0 0; color: var(--text-dark); font-size: var(--font-size-sm);">
              Étape en cours : Collecte des lignes de prestation (3/5 étapes complétées)
            </p>
          </div>

          <div class="form-actions" style="border: none; padding: 0; margin: 0;">
            <%= link_to "#", class: "btn-outline btn-sm" do %>
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M9 18l6-6-6-6"></path>
              </svg>
              <span>Voir les détails</span>
            <% end %>
          </div>
        </div>
      </div>
    </div>

    <!-- Completed Conversation -->
    <div class="admin-card" style="border-left: 4px solid #10B981; margin-bottom: var(--spacing-md);">
      <div style="display: flex; gap: var(--spacing-md); align-items: flex-start;">
        <div class="activity-icon bg-green" style="flex-shrink: 0;">
          <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
            <path d="M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z"/>
          </svg>
        </div>
        <div style="flex: 1;">
          <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: var(--spacing-sm);">
            <div>
              <h4 style="margin: 0 0 var(--spacing-xs) 0; color: var(--text-dark);">Création de facture - Entreprise Martin</h4>
              <p class="text-muted small" style="margin: 0;">Conversation avec Pierre Martin • +33 6 45 78 91 23</p>
            </div>
            <span class="status-badge status-success">Terminée</span>
          </div>
          
          <div class="details-list" style="margin-bottom: var(--spacing-md);">
            <div class="detail-item">
              <span class="detail-label">Type</span>
              <span class="detail-value">
                <span class="badge badge-purple">Création de facture</span>
              </span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Démarrée le</span>
              <span class="detail-value">28 octobre 2025 à 16:40</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Terminée le</span>
              <span class="detail-value">28 octobre 2025 à 16:58</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Durée</span>
              <span class="detail-value">18 minutes</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Messages échangés</span>
              <span class="detail-value">24 messages</span>
            </div>
          </div>

          <div style="padding: var(--spacing-sm); background-color: #D1FAE5; border-radius: var(--radius-md); margin-bottom: var(--spacing-sm);">
            <strong style="font-size: var(--font-size-sm); color: #065F46;">Résultat:</strong>
            <p style="margin: 0.5rem 0 0 0; color: #065F46; font-size: var(--font-size-sm);">
              Facture FACT-2025-0028 créée avec succès pour un montant de 16 590,00 €
            </p>
          </div>

          <div class="form-actions" style="border: none; padding: 0; margin: 0;">
            <%= link_to "#", class: "btn-outline btn-sm" do %>
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M9 18l6-6-6-6"></path>
              </svg>
              <span>Voir les détails</span>
            <% end %>
            <%= link_to "#", class: "btn-outline btn-sm" do %>
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
              </svg>
              <span>Voir la facture</span>
            <% end %>
          </div>
        </div>
      </div>
    </div>

    <!-- Another Completed Conversation -->
    <div class="admin-card" style="border-left: 4px solid #10B981; margin-bottom: var(--spacing-md);">
      <div style="display: flex; gap: var(--spacing-md); align-items: flex-start;">
        <div class="activity-icon bg-blue" style="flex-shrink: 0;">
          <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
            <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12z"/>
          </svg>
        </div>
        <div style="flex: 1;">
          <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: var(--spacing-sm);">
            <div>
              <h4 style="margin: 0 0 var(--spacing-xs) 0; color: var(--text-dark);">Création de devis - Résidence Les Pins</h4>
              <p class="text-muted small" style="margin: 0;">Conversation avec Sophie Bernard • +33 6 23 45 67 89</p>
            </div>
            <span class="status-badge status-success">Terminée</span>
          </div>
          
          <div class="details-list" style="margin-bottom: var(--spacing-md);">
            <div class="detail-item">
              <span class="detail-label">Type</span>
              <span class="detail-value">
                <span class="badge badge-blue">Création de devis</span>
              </span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Démarrée le</span>
              <span class="detail-value">25 octobre 2025 à 14:25</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Terminée le</span>
              <span class="detail-value">25 octobre 2025 à 14:45</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Durée</span>
              <span class="detail-value">20 minutes</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Messages échangés</span>
              <span class="detail-value">18 messages</span>
            </div>
          </div>

          <div style="padding: var(--spacing-sm); background-color: #D1FAE5; border-radius: var(--radius-md); margin-bottom: var(--spacing-sm);">
            <strong style="font-size: var(--font-size-sm); color: #065F46;">Résultat:</strong>
            <p style="margin: 0.5rem 0 0 0; color: #065F46; font-size: var(--font-size-sm);">
              Devis DEVIS-2025-0042 créé et envoyé par WhatsApp pour un montant de 16 590,00 €
            </p>
          </div>

          <div class="form-actions" style="border: none; padding: 0; margin: 0;">
            <%= link_to "#", class: "btn-outline btn-sm" do %>
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M9 18l6-6-6-6"></path>
              </svg>
              <span>Voir les détails</span>
            <% end %>
            <%= link_to "#", class: "btn-outline btn-sm" do %>
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
              </svg>
              <span>Voir le devis</span>
            <% end %>
          </div>
        </div>
      </div>
    </div>

    <!-- Abandoned Conversation -->
    <div class="admin-card" style="border-left: 4px solid #F59E0B; margin-bottom: var(--spacing-md);">
      <div style="display: flex; gap: var(--spacing-md); align-items: flex-start;">
        <div class="activity-icon bg-orange" style="flex-shrink: 0;">
          <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
            <path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
          </svg>
        </div>
        <div style="flex: 1;">
          <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: var(--spacing-sm);">
            <div>
              <h4 style="margin: 0 0 var(--spacing-xs) 0; color: var(--text-dark);">Création de client - Nouveau contact</h4>
              <p class="text-muted small" style="margin: 0;">Conversation avec +33 6 78 90 12 34</p>
            </div>
            <span class="status-badge status-warning">Abandonnée</span>
          </div>
          
          <div class="details-list" style="margin-bottom: var(--spacing-md);">
            <div class="detail-item">
              <span class="detail-label">Type</span>
              <span class="detail-value">
                <span class="badge badge-yellow">Création de client</span>
              </span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Démarrée le</span>
              <span class="detail-value">22 octobre 2025 à 11:30</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Dernière activité</span>
              <span class="detail-value">22 octobre 2025 à 11:35 (il y a 8 jours)</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Messages échangés</span>
              <span class="detail-value">5 messages</span>
            </div>
          </div>

          <div style="padding: var(--spacing-sm); background-color: #FEF3C7; border-radius: var(--radius-md); margin-bottom: var(--spacing-sm);">
            <strong style="font-size: var(--font-size-sm); color: #92400E;">Raison:</strong>
            <p style="margin: 0.5rem 0 0 0; color: #92400E; font-size: var(--font-size-sm);">
              Aucune réponse du client depuis plus de 30 minutes à l'étape de collecte d'adresse
            </p>
          </div>

          <div class="form-actions" style="border: none; padding: 0; margin: 0;">
            <%= link_to "#", class: "btn-outline btn-sm" do %>
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M9 18l6-6-6-6"></path>
              </svg>
              <span>Voir les détails</span>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Pagination -->
  <div class="pagination">
    <button class="btn btn-secondary btn-sm" disabled>
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M15 18l-6-6 6-6"></path>
      </svg>
      Précédent
    </button>
    <span class="pagination-info">Page 1 sur 5</span>
    <button class="btn btn-secondary btn-sm">
      Suivant
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M9 18l6-6-6-6"></path>
      </svg>
    </button>
  </div>
</div>
