<% content_for :title, "Tableau de bord - Devis WhatsApp" %>

<div class="admin-page-header">
  <div>
    <h1>Tableau de bord</h1>
    <p class="text-muted">Bienvenue sur votre assistant de devis et facturation WhatsApp</p>
  </div>
  <%= link_to whatsapp_connect_path, class: "btn btn-primary" do %>
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
    </svg>
    <span>Connecter WhatsApp</span>
  <% end %>
</div>

<!-- WhatsApp Connection Alert -->
<div class="alert-item info" style="margin-bottom: var(--spacing-xl);">
  <div class="alert-icon">ℹ️</div>
  <div class="alert-content">
    <div class="alert-title">Connectez votre WhatsApp</div>
    <div class="alert-meta">Pour commencer à créer des devis et factures par commande vocale, connectez votre compte WhatsApp personnel. C'est simple et sécurisé !</div>
  </div>
  <div style="display: flex; justify-content: flex-end;">
    <%= link_to whatsapp_connect_path, class: "btn btn-sm btn-primary", style: "width: auto;" do %>
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
        <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
      </svg>
      <span>Voir le guide →</span>
    <% end %>
  </div>
</div>

<!-- Statistics Cards -->
<div class="stats-grid">
  <div class="stat-card stat-card-primary">
    <div class="stat-icon stat-icon-primary">
      <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
        <polyline points="14 2 14 8 20 8"></polyline>
        <line x1="16" y1="13" x2="8" y2="13"></line>
        <line x1="16" y1="17" x2="8" y2="17"></line>
        <polyline points="10 9 9 9 8 9"></polyline>
      </svg>
    </div>
    <div class="stat-content">
      <div class="stat-value"><%= @quotes_count %></div>
      <div class="stat-label">Devis créés</div>
      <div class="stat-change neutral">Ce mois-ci</div>
    </div>
  </div>

  <div class="stat-card stat-card-primary">
    <div class="stat-icon stat-icon-primary">
      <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
        <polyline points="14 2 14 8 20 8"></polyline>
        <line x1="9" y1="15" x2="15" y2="15"></line>
      </svg>
    </div>
    <div class="stat-content">
      <div class="stat-value"><%= @invoices_count %></div>
      <div class="stat-label">Factures créées</div>
      <div class="stat-change neutral">Ce mois-ci</div>
    </div>
  </div>

  <div class="stat-card stat-card-primary">
    <div class="stat-icon stat-icon-primary">
      <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
        <circle cx="9" cy="7" r="4"></circle>
        <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
      </svg>
    </div>
    <div class="stat-content">
      <div class="stat-value"><%= @clients_count %></div>
      <div class="stat-label">Clients actifs</div>
      <div class="stat-change neutral">Total</div>
    </div>
  </div>

  <div class="stat-card stat-card-primary">
    <div class="stat-icon stat-icon-primary">
      <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="12" y1="1" x2="12" y2="23"></line>
        <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
      </svg>
    </div>
    <div class="stat-content">
      <div class="stat-value"><%= number_to_currency(@total_revenue, unit: "", format: "%n", precision: 0) %> €</div>
      <div class="stat-label">Chiffre d'affaires</div>
      <div class="stat-change neutral">Ce mois-ci</div>
    </div>
  </div>
</div>

<!-- Main Content Grid -->
<div class="admin-content-grid">
  <!-- Recent Activity Section -->
  <div class="admin-card">
    <div class="card-header">
      <h2>
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: inline-block; vertical-align: middle; margin-right: 0.5rem;">
          <line x1="18" y1="20" x2="18" y2="10"></line>
          <line x1="12" y1="20" x2="12" y2="4"></line>
          <line x1="6" y1="20" x2="6" y2="14"></line>
        </svg>
        Activité récente
      </h2>
      <div style="margin-left: auto; display: inline-flex;">
        <%= link_to conversations_path, class: "btn btn-xs btn-outline" do %>
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M9 18l6-6-6-6"></path>
          </svg>
          <span>Voir tout</span>
        <% end %>
      </div>
    </div>
    <div style="padding: var(--spacing-xl); text-align: center;">
      <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" style="margin: 0 auto 1rem; color: var(--text-gray);">
        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
      </svg>
      <h3 style="font-weight: 600; color: var(--text-dark); margin-bottom: 0.5rem;">Aucune activité récente</h3>
      <p style="color: var(--text-muted); margin-bottom: 1.5rem;">
        Vos conversations WhatsApp et documents créés apparaîtront ici.
        Commencez par connecter votre WhatsApp pour créer votre premier devis !
      </p>
      <%= link_to "Connecter WhatsApp", whatsapp_connect_path, class: "btn btn-sm btn-primary" %>
    </div>
  </div>

  <!-- Quick Actions Section -->
  <div class="admin-card">
    <div class="card-header">
      <h2>
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: inline-block; vertical-align: middle; margin-right: 0.5rem;">
          <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
        </svg>
        Actions rapides
      </h2>
    </div>
    <div class="activity-list">
      <div class="activity-item">
        <div class="activity-icon bg-green">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
            <polyline points="14 2 14 8 20 8"></polyline>
            <line x1="16" y1="13" x2="8" y2="13"></line>
            <line x1="16" y1="17" x2="8" y2="17"></line>
          </svg>
        </div>
        <div class="activity-content">
          <div class="activity-title">Créer un devis</div>
          <div class="activity-meta">Envoyez <strong>"créer un devis"</strong> ou <strong>"nouveau devis"</strong> sur WhatsApp</div>
        </div>
      </div>
      
      <div class="activity-item">
        <div class="activity-icon bg-green">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
            <polyline points="14 2 14 8 20 8"></polyline>
            <line x1="9" y1="15" x2="15" y2="15"></line>
          </svg>
        </div>
        <div class="activity-content">
          <div class="activity-title">Créer une facture</div>
          <div class="activity-meta">Envoyez <strong>"créer une facture"</strong> ou <strong>"nouvelle facture"</strong> sur WhatsApp</div>
        </div>
      </div>
      
      <div class="activity-item">
        <div class="activity-icon bg-green">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
            <circle cx="12" cy="7" r="4"></circle>
          </svg>
        </div>
        <div class="activity-content">
          <div class="activity-title">Ajouter un client</div>
          <div class="activity-meta">Envoyez <strong>"créer un client"</strong> ou <strong>"nouveau client"</strong> sur WhatsApp</div>
        </div>
      </div>
      
      <div class="activity-item">
        <div class="activity-icon bg-green">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"></circle>
            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
            <line x1="12" y1="17" x2="12.01" y2="17"></line>
          </svg>
        </div>
        <div class="activity-content">
          <div class="activity-title">Obtenir de l'aide</div>
          <div class="activity-meta">Envoyez <strong>"aide"</strong> ou <strong>"help"</strong> sur WhatsApp</div>
        </div>
      </div>
    </div>
    
    <div style="padding: var(--spacing-lg); display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.5rem; border-top: 1px solid var(--border-color);">
      <%= link_to clients_path, class: "btn btn-sm btn-outline" do %>
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
          <circle cx="9" cy="7" r="4"></circle>
          <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
          <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
        </svg>
        <span>Gérer les clients</span>
      <% end %>
      
      <%= link_to quotes_path, class: "btn btn-sm btn-outline" do %>
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
        </svg>
        <span>Voir les devis</span>
      <% end %>
      
      <%= link_to invoices_path, class: "btn btn-sm btn-outline" do %>
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="9" y1="15" x2="15" y2="15"></line>
        </svg>
        <span>Voir les factures</span>
      <% end %>
    </div>
  </div>
</div>

<!-- Subscription Status Section -->
<div class="admin-card" style="margin-top: var(--spacing-xl); background: linear-gradient(135deg, var(--primary-green) 0%, var(--dark-green) 100%); color: white; border: none;">
  <div style="padding: var(--spacing-xl); display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;">
    <div style="display: flex; gap: 1rem; align-items: center;">
      <div style="font-size: 2rem;">✅</div>
      <div>
        <h3 style="font-size: 1.125rem; font-weight: 600; margin: 0 0 0.25rem 0;">Abonnement actif</h3>
        <p style="margin: 0; opacity: 0.9; font-size: 0.875rem;">Votre abonnement mensuel est actif. Profitez de toutes les fonctionnalités !</p>
      </div>
    </div>
    <div>
      <%= button_to client_subscription_path, method: :post, class: "btn btn-outline", style: "background: transparent; color: white; border: 1px solid white; display: inline-flex; align-items: center; gap: 0.5rem;" do %>
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect>
          <line x1="1" y1="10" x2="23" y2="10"></line>
        </svg>
        <span>Gérer l'abonnement</span>
      <% end %>
    </div>
  </div>
</div>

<!-- Features Overview -->
<div class="admin-card" style="margin-top: var(--spacing-xl);">
  <div class="card-header">
    <h2>
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: inline-block; vertical-align: middle; margin-right: 0.5rem;">
        <circle cx="12" cy="12" r="10"></circle>
        <path d="M8 14s1.5 2 4 2 4-2 4-2"></path>
        <line x1="9" y1="9" x2="9.01" y2="9"></line>
        <line x1="15" y1="9" x2="15.01" y2="9"></line>
      </svg>
      Comment ça marche ?
    </h2>
  </div>
  <div class="quick-stats-grid">
    <div class="quick-stat">
      <div style="font-size: 2.5rem; margin-bottom: 1rem; text-align: center;">📱</div>
      <div style="position: absolute; top: 1rem; right: 1rem; width: 2rem; height: 2rem; background: var(--bg-light); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; color: var(--text-dark); font-size: 0.875rem;">1</div>
      <div class="quick-stat-label" style="text-align: center; font-weight: 600; margin-bottom: 0.5rem;">Connectez WhatsApp</div>
      <div class="quick-stat-value" style="font-size: 0.875rem; color: var(--text-muted); text-align: center;">Scannez le QR code pour connecter votre compte en toute sécurité</div>
    </div>
    
    <div class="quick-stat">
      <div style="font-size: 2.5rem; margin-bottom: 1rem; text-align: center;">🎤</div>
      <div style="position: absolute; top: 1rem; right: 1rem; width: 2rem; height: 2rem; background: var(--bg-light); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; color: var(--text-dark); font-size: 0.875rem;">2</div>
      <div class="quick-stat-label" style="text-align: center; font-weight: 600; margin-bottom: 0.5rem;">Commandes vocales</div>
      <div class="quick-stat-value" style="font-size: 0.875rem; color: var(--text-muted); text-align: center;">Créez devis et factures par message vocal ou texte</div>
    </div>
    
    <div class="quick-stat">
      <div style="font-size: 2.5rem; margin-bottom: 1rem; text-align: center;">🤖</div>
      <div style="position: absolute; top: 1rem; right: 1rem; width: 2rem; height: 2rem; background: var(--bg-light); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; color: var(--text-dark); font-size: 0.875rem;">3</div>
      <div class="quick-stat-label" style="text-align: center; font-weight: 600; margin-bottom: 0.5rem;">Assistant IA</div>
      <div class="quick-stat-value" style="font-size: 0.875rem; color: var(--text-muted); text-align: center;">L'assistant vous guide étape par étape</div>
    </div>
    
    <div class="quick-stat">
      <div style="font-size: 2.5rem; margin-bottom: 1rem; text-align: center;">📄</div>
      <div style="position: absolute; top: 1rem; right: 1rem; width: 2rem; height: 2rem; background: var(--bg-light); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; color: var(--text-dark); font-size: 0.875rem;">4</div>
      <div class="quick-stat-label" style="text-align: center; font-weight: 600; margin-bottom: 0.5rem;">PDF automatiques</div>
      <div class="quick-stat-value" style="font-size: 0.875rem; color: var(--text-muted); text-align: center;">Recevez instantanément vos documents sur WhatsApp</div>
    </div>
  </div>
</div>

<!-- Help Section -->
<div class="alert-item info" style="margin-top: var(--spacing-xl);">
  <div class="alert-icon">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
      <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
    </svg>
  </div>
  <div class="alert-content">
    <div class="alert-title">Besoin d'aide ?</div>
    <div class="alert-meta">Consultez nos guides ou envoyez "aide" sur WhatsApp pour découvrir toutes les commandes disponibles.</div>
  </div>
  <div style="display: flex; justify-content: flex-end;">
    <%= link_to "#", class: "btn btn-sm btn-outline", style: "width: auto;" do %>
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="12" cy="12" r="10"></circle>
        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
        <line x1="12" y1="17" x2="12.01" y2="17"></line>
      </svg>
      <span>Guide d'utilisation</span>
    <% end %>
  </div>
</div>
