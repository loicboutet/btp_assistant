<!DOCTYPE html>
<html>
  <head>
    <title><%= content_for(:title) || "Devis WhatsApp" %></title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    
    <style>
      /* Reset & Base Styles */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        font-size: 11pt;
        line-height: 1.6;
        color: #333;
        background: white;
      }
      
      /* Print Styles */
      @media print {
        body {
          margin: 0;
          padding: 0;
        }
        
        .no-print {
          display: none !important;
        }
        
        .page-break {
          page-break-after: always;
        }
        
        @page {
          margin: 1.5cm;
          size: A4;
        }
      }
      
      /* Screen Styles */
      @media screen {
        body {
          padding: 20px;
          background: #f5f5f5;
        }
        
        .container {
          max-width: 210mm;
          margin: 0 auto;
          background: white;
          box-shadow: 0 0 10px rgba(0,0,0,0.1);
          padding: 20mm;
        }
        
        .print-button {
          position: fixed;
          top: 20px;
          right: 20px;
          background: #22c55e;
          color: white;
          border: none;
          padding: 12px 24px;
          border-radius: 8px;
          font-weight: 600;
          cursor: pointer;
          box-shadow: 0 4px 6px rgba(0,0,0,0.1);
          z-index: 1000;
        }
        
        .print-button:hover {
          background: #16a34a;
        }
      }
      
      /* Document Styles */
      .header {
        display: flex;
        justify-content: space-between;
        align-items: start;
        margin-bottom: 40px;
        padding-bottom: 20px;
        border-bottom: 3px solid #22c55e;
      }
      
      .company-info {
        flex: 1;
      }
      
      .company-name {
        font-size: 20pt;
        font-weight: bold;
        color: #22c55e;
        margin-bottom: 8px;
      }
      
      .company-details {
        font-size: 9pt;
        color: #666;
        line-height: 1.5;
      }
      
      .document-info {
        text-align: right;
        flex: 1;
      }
      
      .document-title {
        font-size: 24pt;
        font-weight: bold;
        color: #333;
        margin-bottom: 8px;
      }
      
      .document-number {
        font-size: 11pt;
        color: #666;
        margin-bottom: 4px;
      }
      
      .document-date {
        font-size: 9pt;
        color: #999;
      }
      
      .parties {
        display: flex;
        justify-content: space-between;
        margin-bottom: 40px;
      }
      
      .party-box {
        flex: 1;
        padding: 15px;
        background: #f9fafb;
        border: 1px solid #e5e7eb;
        border-radius: 4px;
      }
      
      .party-box + .party-box {
        margin-left: 20px;
      }
      
      .party-label {
        font-size: 9pt;
        text-transform: uppercase;
        color: #6b7280;
        margin-bottom: 8px;
        font-weight: 600;
      }
      
      .party-name {
        font-size: 12pt;
        font-weight: bold;
        color: #111;
        margin-bottom: 4px;
      }
      
      .party-details {
        font-size: 9pt;
        color: #666;
        line-height: 1.6;
      }
      
      .items-table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 30px;
      }
      
      .items-table thead {
        background: #f3f4f6;
      }
      
      .items-table th {
        text-align: left;
        padding: 12px 8px;
        font-size: 9pt;
        text-transform: uppercase;
        color: #6b7280;
        font-weight: 600;
        border-bottom: 2px solid #e5e7eb;
      }
      
      .items-table th:last-child,
      .items-table td:last-child {
        text-align: right;
      }
      
      .items-table tbody tr {
        border-bottom: 1px solid #f3f4f6;
      }
      
      .items-table td {
        padding: 12px 8px;
        font-size: 10pt;
      }
      
      .item-description {
        color: #111;
        font-weight: 500;
      }
      
      .item-quantity {
        color: #666;
      }
      
      .totals {
        margin-left: auto;
        width: 300px;
        margin-bottom: 40px;
      }
      
      .totals-row {
        display: flex;
        justify-content: space-between;
        padding: 8px 0;
        font-size: 10pt;
      }
      
      .totals-row.subtotal {
        color: #666;
      }
      
      .totals-row.vat {
        color: #666;
        border-bottom: 1px solid #e5e7eb;
        padding-bottom: 12px;
        margin-bottom: 12px;
      }
      
      .totals-row.total {
        font-size: 14pt;
        font-weight: bold;
        color: #22c55e;
        padding-top: 12px;
        border-top: 2px solid #333;
      }
      
      .notes {
        background: #fef3c7;
        border-left: 4px solid #f59e0b;
        padding: 15px;
        margin-bottom: 30px;
        border-radius: 4px;
      }
      
      .notes-title {
        font-weight: bold;
        color: #92400e;
        margin-bottom: 8px;
        font-size: 10pt;
      }
      
      .notes-content {
        color: #78350f;
        font-size: 9pt;
        line-height: 1.6;
        white-space: pre-line;
      }
      
      .footer {
        margin-top: 50px;
        padding-top: 20px;
        border-top: 1px solid #e5e7eb;
        font-size: 8pt;
        color: #999;
        text-align: center;
      }
      
      .signature-section {
        margin-top: 50px;
        display: flex;
        justify-content: space-between;
      }
      
      .signature-box {
        width: 45%;
        text-align: center;
      }
      
      .signature-label {
        font-size: 9pt;
        color: #666;
        margin-bottom: 50px;
        font-weight: 600;
      }
      
      .signature-line {
        border-top: 1px solid #333;
        padding-top: 8px;
        font-size: 8pt;
        color: #999;
      }
    </style>
  </head>
  
  <body>
    <button onclick="window.print()" class="print-button no-print">
      üñ®Ô∏è Imprimer / Sauvegarder en PDF
    </button>
    
    <div class="container">
      <%= yield %>
    </div>
  </body>
</html>
